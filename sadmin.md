# Linux commands

Некоторые команды linux

## Less

Чтение содержимого файла, можно посмотреть или поискать вхождения.

```bash 
  less text.txt;
  
  # можно поискать содержимое /<наименование>


```


## Каталоги Linux

- /bin - двоичные файлы для загрузки системы
- /boot - файлы для загрузки, grub и ядро
- /dev - все устройства
- /etc - конфигурация
- /home - файлы юзеров
- /lost - аварийное восстановление
- /media - флешки, дисковводы 
- /mnt - примонтированные папки
- /opt - необязательное по
- /proc - файлы, доступные для чтения, помогают увидеть компьютер "глазами" ядра
- /root - домашний каталог пользователя Root
- /sbin - задачи под root, необходимые системе
- /tmp - временные файлы
- /usr - все файлы поддержки
- /usr/bin - исполняемые программы
- /usr/share - папки, используемые программами
- /usr/sbin - доп файлы для админа
- /usr/local/ - для установки программ не из дистрибутива
- /usr/lib/ - разделяемые библиотеки программ
- /usr/share/doc - доки
- /var - часто изменяемые файлы: бд, буффер, почта
- /var/log - логи

## CP

cp - копирование файлов
```bash
  cp file1 file2 dir1; # скопировать file1, file2 (перечисление файлов не ограничего) в папку dir1
  
  cp file1 file2; # переименовать файл один в другой

```

## MV 

Перемещение файлов. Исходный файл всегда пропадает. Если вторая папка из указанных в аргументах существует, в нее переместится файл, если нет, первый файл будет переименован во второй. 

```bash
  mv file1 file2; 

```

## RM

Удаление файлов. Можно удалить по текстовому шаблону. При работе с символической ссылкой удаляет ее, а не целевой файл

```bash
  rm file1;
  rm *.txt; # удалить все текстовые файлы

```

## LN

Создание ссылок. Без параметра создается дополнительный указатель на содержимое файла.

```bash
ln dir dir_link;
```

## type

Получить тип команды
```bash
type ls
```
## which 

Определение местоположения исполняемого файла. Не способная выявлять встроенные команды или псевдонимы.

```bash
which ls;
```

## help 

Справка по команде. вертикальная черта - взаимоисключающие параметры, параметры в скобочках - опциональные.

```bash
cd --help;

```

## man 

Справочник по команде. 

```bash
man ls;
```

## apropos

Поиск схожих значений в мануалах.

```bash
apopos test;
```

## whatis

Вывод краткого описания команды.

```bash
 whatis touch;
```

## info 

Вывод описания программы. С ссылками на другие узлы.

```bash

 info ls;
```

## alias

Создание собственной команды.

```bash
alias foo='cd ..';

```

## unalias

Удаление алиаса.

```bash

unalias foo;
```

## > >>

Перенаправление вывода stdOut (standart out). Если перенаправляем в файл, его содержимое перезаписывается.

```bash
ls -l > text.txt;

# >> - добавит данные в конец файла

```

## stderror

Чтобы перенаправить ошибку, надо указать файловый дескриптор (0 - ввод, 1 - вывод, 2 - ошибка)

```bash
ls /'несуществующая папка' 2> error.txt
```

## комбинация выводов

```bash
ls /'несуществующая папка' > output.txt 2>&1;

## сокращенная запись
ls /'несуществующая папка' &> output.txt;


```

## Заглушить вывод

```bash
ls -l /<'несуществующая папка' 2> /dev/null ## по-старому "битоприемник"

```

## cat 

Выводит содержимое одного или нескольких файлов. Если без аргументов, то выведет то, что вводится с клавиатуры. 

```bash
cat *.txt; 
```

Можно перенаправить в один файл.

```bash
cat *.txt > result.txt;

```
Можно получить данные для этой функции из файла.

```bash

cat < result.txt;

```
## | 

Конвеер. Перенаправляем вывод одной програм во ввод другой.

```bash
ls | less;


```

## Фильтр sort

Можно поместить в конвейер команду, которая как-то фильтрует ввод и дает отфильтрованный вывод.

```bash
ls | sort;

```
## Фильтр uniq

Удаляет повторяющиеся строки. Можно вывести повторяющиеся значения с параметром -d.

```bash
ls | uniq;
```

## wc число строк, слов и байтов

```bash 

ls | wc -l; # l - только количество строк

```

## grep

Поиск текстового шаблона в файлах. Может работать с выводом.


```bash
ls grep test;

# -i - игнорирование регистра
# -v - выводить строки, где совпадения не найдены


```

## head/tail 

Выводят первые и последние строки файлов. Может работать с выводом. Tail -f - следит за файлом или выводом. -n <Number> - количество строк.
  
```bash
ls | head -n 1;

```  

## tee 

Читает ввод и возвращает вывод. Может писать в файл.

```bash
ls | tee ls.txt | sort;

```
## echo

Можно подставить вычисление внутри echo.

```bash
echo $(( 2 + 3 )); # 5

```
## echo {}

Через фигурные скобки можно создать диапазон. При совместном использовании перемножают друг друга, чтобы учесть все комбинации.

```bash 
  echo number_{1..5};

```

## Подстановка переменных 

В строку можно подставить переменные. 

```bash
echo $USER; #заданная переменная
printenv | less; #список переменных

```

## () - вставка результата выполнения

В консоль можно вывести результат выполнения другой команды.

```bash
echo $(ls);

```
## Экранирование

К файлам с двойным названием можно обратиться через двойные кавычки. Но подстановка ($),  арифметика и подстановка команд будут работать.

```bash
ls -l "Два слова".txt;
echo "$USER $((2+2)) $(cal)";

```

## Одиночные кавычки

Одиночные кавычки подавляют подстановку.

```bash
echo '$USER'; # $USER
```

## Экранирование

Можно экранировать спец символ.

```bash
echo $USER \$5.00;
```
## Управляющие последовательности

- \a - звонок
- \b - backscape
- \n - новая строка
- \r - вовзврат каретки
- \t - табуляция

## Команды для клавиатуры

- ctrl + A - курсор в начало строки
- ctrl + E - курсор в конец строки
- ctrl + F - перемещение на один символ вперед
- ctrl + B - перемещение на один символ назад
- alt + F - перемещение на слово вперед
- alt + B - перемещение на слово назад
- ctrl + L - очистка консоли, курсор влево

## Команды для редактироваия текста

- ctrl + D - удаление символа в позиции курсора
- ctrl + T - меняет местами два символа
- alt + T - меняет местами слова
- alt + L - приводит в нижний регистр, начиная от курсора и до конца слова
- alt + U - то же самое, что и предыдущая, только с верхним регистром
- ctrl + K - удаляет от курсора и до конца строки
- ctrl + U - удаляет от курсора и до начала строки
- alt + D - удаляет символы от курсора до конца слова
- alt + BACKSPACE - удаляет буквы от курсора до конца слова
- ctrl + Y - извлекает текст из буфера и вставляет его в позицию курсора

## Дополнения

- Можно вывести все варианты вставок через двойное нажатие TAB
- Можно вставить все варианты через комбинацию ALT + *

## ! - поиск по истории

Можно выполнить поиск по ID события. 

```bash
!88
```

Поиск по истории в обратном порядке.
ctrl + R - позволяет ввести значение и сразу его вывести.
Для выполнения команды нажать ENTER. Для копирования в командную строку CTRL + J.

Команды для работы с историей:
- CTRL + P - переход к предыдущей записи в истории
- CTRL + N - переход к следующей записи в истории
- ALT + < - переход в начало истории
- ALT + > - переход в конец истории
- ALT + P - поиск по сабмиту в обратном порядке
- ALT + N - поиск по сабмиту в прямом порядке
- ALT + 0 - выполнить текущую команду в списке истории 

## Подстановка из истории

- !! - последняя команда
- !<число> - команда с номером
- !<строка> - команда из истории, начинающаяся со строки
- !?<строка> - команда, содержащая строку

## Типы файлов

- "-" обычный
- d директория
- c файл терминала, модема
- b файл жесткого диска
- l символическая ссылка

## chmod

Через эту функцию можно добавлять права через символическое представление:

Пользователи:

Символ | Значение
---|---
u | Владелец
g | Группа
o | Другие
a | все, можно не указывать перед операцией, +x

Операции:

Символ | Операция
---|---
"+" | Добавить права
"-" | Убрать права
"=" | Только указанные применить, остальные удалить 

Пример:

```bash

u+x; # добавляет право на выполнение у владельца

```

## umask
Маска создания прав. По-умолчанию 0002. 7 - отбирает все права, 2 - отбирает права на запись, 0 - оставляет все как есть. Маска вычитается из прав. 777 - 002 = 775.

```bash
umask 0007;

```
## Смена идентичности

Загрузка окружения и домашнего каталога.

```bash
sudo su -l; 

```
Включение суперюзера в Ubuntu.
```bash
sudo -i;

```

## Исполнение команды в окружении суперюзера, не входя в интерактивный режим

```bash
  sudo su -c 'ls'
```

## Sudo

Позоляет запускать команду от именю суперпользователя, не применяя его окружение. Также можно не экранировать команды через sudo.

```bash
sudo service postgresql start;
```

## Chown

Для определения владельцев файла нужно использовать команду chown. 


```bash

sudo chown root:root test.txt;
sudo chown <user>:<user-group> <file>;

```

## passwd

Смена пароля.

```bash 

passwd;
passwd <user name>;

```

## ps

Вывод выполняемых процессов в системе.

```bash
ps x; # расширенная информация
ps aux; # Еще более полная информация
```

## top

Показывает процессы в реальном времени.

```bash

top;
q; # выход

```

## Фоновый режим

Для запуска в фоновом режиме надо набрать команду с & на конце.
Для просмотра запущенных команд bash вызывать команду jobs.

```bash
xlogo &;
jobs;


```

## Возврат из фонового режима

Для возвращения под контроль нужно вызвать команду fg.

```bash 
jobs; # получаем id процесса
fg %1; - возвращаем под контроль


```
## Сигнал команде

```bash
xlogo &; # возвращается ID процесса
kill <ID процесса>; #посылается сигнал на отключение процесса
```

## Сигналы kill

Номер | Имя | Значение
---|---|---
1 | HUP | Оборвать связь
2 | INT | Прервать, аналог CTRL + C
9 | KILL | Уничтожить. Ядро завершает процесс
15 | TERM | Завершить программно
18 | CONT | Продолжить работу программы после команды "STOP"
19 | STOP | Приостановить в ядре


```bash
xlogo &;
kill -1 <pid>;
kill -SIGINT <pid>; # передать аргумент по имении с префиксом SIG
kill -INT <pid>; # без префикса
```

## Killall

Для завершения всех однотипных процессов.

```bash
killall xlogo;
```

## Команды процессов

### pstree
Выводит дерево процессов
### vmstat
Снимок потребляемых ресурсов.
### xload 
Изенение нагрузки с течением времени
### tload
График в терминале с нагрузкой

## Printenv

Выводит переменные окружения
```bash
printenv USER; # значение конкретной переменной
printenv; # Все переменные окружения
```

# set | less

set без параметров выводит переменные оболочки и окружения, отсортированные в алфавитном порядке.
```bash
set | less; 

```

# Разные переменные окружения
Сначала запускаются общие переменные, потом к ним добавляются переменные юзера. В Ubuntu файлы с окружением лежат внутри папки юзера.


Название | Описание
---|---
DISPLAY | Имя дисплея при работе в графическом окружении
EDITOR | Имя текстового редактора
SHELL | Имя командной оболочки
HOME | Путь к домашнему каталогу
LANG | Набор символов и порядок сортировки для используемого языка
OLD_PWD | Предыдущий рабочий каталог
PAGER | Имя программы для постраничного просмотра
PATH | Списки каталогов, в которых производится поиск выполняемых программ по имени
PSI | Приглашение к вводу
PWD | Текущий рабочий каталог
TERM | Тип терминала
TZ | Часовой пояс
USER | Юзер

# export
Предоставить доступ дочерним процессам оболочки

```bash

export PATH

```
# VI / VIM
Команда | Описание
--- | ---
0 | Начало текущей строки
SHIFT + 6 | К первому непробельному символу в строке
SHIFT + 4 | В конец текущей строки
W | В начало следующего слова или к знаку препинания
SHIFT + W | В начало следующего слова, игнорируя знаки препинания  
B | В начало предыдущего слова или знака препинания
SHIFT + B | В начало предыдущего слова, минуя знаки препинания
CTRL + F | Вниз на одну страницу
CTRL + B | Вверх на одну страницу
<число> + SHIFT + G | К строке с указанным номером
SHIFT + G | К последней строке файла
  
## Операции командного режима
Команда | Описание
--- | ---
U | Отмена последнего действия
a | Включение режима вставки после последнего символа (vi не дает навести курсор туда)
A | Переход в конец и включение режима вставки
o | Вставить строку ниже текущей
O | Вставить строку выше текущей
  
### Удаление   
Команда | Описание
--- | ---
x | Удалить текущий символ
<число>x | Удалить от текущего символа указанное количество
dd | Удалить текущую строку
<число>dd | Удалить указанное количество строк от курсора  
dw | Удалить от курсора до начала следующего
d$ | Удалить от курсора до конца строки
d0 | От курсора до начала строки
d^ | От текущего символа до первого непробельного символа
dG | От текущей строки до конца файла
d<Строка>G | От текущей строки до n-строки файла

Команда d вырезает текст в буфер, вставить его можно с помощью команды "p" - вставить справа от курсора, "P" - слева от курсора.
  
### Копирование 
Команда | Описание
--- | ---
yy | Копировать строку
<число строк>yy | Копировать кол-во строк от текущей
yW | От текущей позиции до начала следующего слова
y$ | От курсора до конца текущей строки
y0 | От курсора до начала строки
y^ | От курсора до первого непробельного символа
yG | От текущей строки до конца файла
y<кол-во строк>G | От текущей строки до n-строки файла
  
### Работа со строками
Команда | Описание
---|---
J | Соединяет строки
f<буква> | Поиск по строке, можно повторить командой ;
/ | Поиск по всему файлу, повторить поиск командой n  

